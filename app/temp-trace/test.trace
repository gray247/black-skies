{"version":8,"type":"context-options","origin":"testRunner","browserName":"","options":{},"platform":"win32","wallTime":1762747170616,"monotonicTime":1828.409,"sdkLanguage":"javascript"}
{"type":"before","callId":"hook@1","stepId":"hook@1","startTime":1834.722,"class":"Test","method":"hook","title":"Before Hooks","params":{},"stack":[]}
{"type":"before","callId":"hook@2","stepId":"hook@2","parentId":"hook@1","startTime":1835.365,"class":"Test","method":"hook","title":"beforeEach hook","params":{},"stack":[{"file":"C:\\Dev\\black-skies\\app\\tests\\e2e\\gui.insights.spec.ts","line":14,"column":6}]}
{"type":"before","callId":"fixture@34","stepId":"fixture@34","parentId":"hook@2","startTime":1847.589,"class":"Test","method":"fixture","title":"Fixture \"browser\"","params":{},"stack":[]}
{"type":"before","callId":"pw:api@35","stepId":"pw:api@35","parentId":"fixture@34","startTime":1852.017,"class":"Test","method":"pw:api","title":"Launch browser","params":{"handleSIGINT":"false","headless":"false","env":"[Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object, Object]","tracesDir":"C:\\Dev\\black-skies\\app\\test-results\\.playwright-artifacts-0\\traces","ignoreDefaultArgs":"undefined","ignoreAllDefaultArgs":"false","timeout":"180000"},"stack":[]}
{"type":"after","callId":"pw:api@35","endTime":2055.149,"annotations":[]}
{"type":"after","callId":"fixture@34","endTime":2055.462,"annotations":[]}
{"type":"before","callId":"fixture@38","stepId":"fixture@38","parentId":"hook@2","startTime":2059.531,"class":"Test","method":"fixture","title":"Fixture \"context\"","params":{},"stack":[]}
{"type":"before","callId":"pw:api@39","stepId":"pw:api@39","parentId":"fixture@38","startTime":2063.555,"class":"Test","method":"pw:api","title":"Create context","params":{"acceptDownloads":"accept","bypassCSP":"false","colorScheme":"light","hasTouch":"false","ignoreHTTPSErrors":"false","isMobile":"false","javaScriptEnabled":"true","locale":"en-US","offline":"false","viewport":"Object","serviceWorkers":"allow","recordVideo":"Object","selectorEngines":"[]","testIdAttributeName":"data-testid","noDefaultViewport":"false","extraHTTPHeaders":"undefined","storageState":"undefined","reducedMotion":"undefined","forcedColors":"undefined","contrast":"undefined","clientCertificates":"undefined"},"stack":[]}
{"type":"after","callId":"pw:api@39","endTime":2078.411,"annotations":[]}
{"type":"after","callId":"fixture@38","endTime":2084.971,"annotations":[]}
{"type":"before","callId":"fixture@40","stepId":"fixture@40","parentId":"hook@2","startTime":2085.764,"class":"Test","method":"fixture","title":"Fixture \"page\"","params":{},"stack":[]}
{"type":"before","callId":"pw:api@41","stepId":"pw:api@41","parentId":"fixture@40","startTime":2088.034,"class":"Test","method":"pw:api","title":"Create page","params":{},"stack":[]}
{"type":"after","callId":"pw:api@41","endTime":2227.985,"annotations":[]}
{"type":"after","callId":"fixture@40","endTime":2228.249,"annotations":[]}
{"type":"before","callId":"pw:api@42","stepId":"pw:api@42","parentId":"hook@2","startTime":2235.267,"class":"Test","method":"pw:api","title":"Add init script","params":{"source":"(({\n    project\n  }) => {\n    const layoutCalls = {\n      openFloating: [],\n      saveLayout: [],\n      loadLayout: []\n    };\n    const layoutState = {\n      savedLayout: null,\n      floatingPanes: []\n    };\n    const healthState = {\n      status: 'online'\n    };\n    const services = {\n      async checkHealth() {\n        if (healthState.status === 'online') {\n          return {\n            ok: true,\n            data: {\n              status: 'online'\n            },\n            traceId: 'trace-health'\n          };\n        }\n        return {\n          ok: false,\n          error: {\n            message: 'Bridge offline'\n          },\n          traceId: 'trace-health-offline'\n        };\n      },\n      async buildOutline() {\n        return {\n          ok: true,\n          data: project.outline,\n          traceId: 'trace-outline'\n        };\n      },\n      async preflightDraft() {\n        var _project$scenes$0$id, _project$scenes$, _project$scenes$0$id2, _project$scenes$2, _project$scenes$0$tit, _project$scenes$3, _project$scenes$0$ord, _project$scenes$4, _project$scenes$5;\n        return {\n          ok: true,\n          data: {\n            projectId: project.project_id,\n            unitScope: 'scene',\n            unitIds: [(_project$scenes$0$id = (_project$scenes$ = project.scenes[0]) === null || _project$scenes$ === void 0 ? void 0 : _project$scenes$.id) !== null && _project$scenes$0$id !== void 0 ? _project$scenes$0$id : 'sc_0001'],\n            scenes: [{\n              id: (_project$scenes$0$id2 = (_project$scenes$2 = project.scenes[0]) === null || _project$scenes$2 === void 0 ? void 0 : _project$scenes$2.id) !== null && _project$scenes$0$id2 !== void 0 ? _project$scenes$0$id2 : 'sc_0001',\n              title: (_project$scenes$0$tit = (_project$scenes$3 = project.scenes[0]) === null || _project$scenes$3 === void 0 ? void 0 : _project$scenes$3.title) !== null && _project$scenes$0$tit !== void 0 ? _project$scenes$0$tit : 'Scene',\n              order: (_project$scenes$0$ord = (_project$scenes$4 = project.scenes[0]) === null || _project$scenes$4 === void 0 ? void 0 : _project$scenes$4.order) !== null && _project$scenes$0$ord !== void 0 ? _project$scenes$0$ord : 1,\n              chapter_id: (_project$scenes$5 = project.scenes[0]) === null || _project$scenes$5 === void 0 ? void 0 : _project$scenes$5.chapter_id\n            }],\n            budget: {\n              estimated_usd: 1.25,\n              status: 'ok',\n              soft_limit_usd: 10,\n              hard_limit_usd: 10,\n              spent_usd: 1.25,\n              total_after_usd: 1.25\n            }\n          },\n          traceId: 'trace-preflight'\n        };\n      },\n      async generateDraft() {\n        return {\n          ok: true,\n          data: {\n            draft_id: 'dr_stub',\n            schema_version: 'DraftUnitSchema v1',\n            units: [],\n            budget: {\n              status: 'ok'\n            }\n          },\n          traceId: 'trace-generate'\n        };\n      },\n      async critiqueDraft() {\n        var _project$scenes$0$id3, _project$scenes$6;\n        return {\n          ok: true,\n          data: {\n            unit_id: (_project$scenes$0$id3 = (_project$scenes$6 = project.scenes[0]) === null || _project$scenes$6 === void 0 ? void 0 : _project$scenes$6.id) !== null && _project$scenes$0$id3 !== void 0 ? _project$scenes$0$id3 : 'sc_0001',\n            schema_version: 'CritiqueOutputSchema v1',\n            summary: 'Stub critique summary.',\n            model: {\n              name: 'critique-stub',\n              provider: 'stub'\n            },\n            budget: {\n              estimated_usd: 0.15,\n              status: 'ok',\n              soft_limit_usd: 10,\n              hard_limit_usd: 10,\n              spent_usd: 1.4,\n              total_after_usd: 1.4\n            },\n            line_comments: [],\n            priorities: ['Voice']\n          },\n          traceId: 'trace-critique'\n        };\n      },\n      async acceptDraft() {\n        var _project$scenes$0$id4, _project$scenes$7;\n        return {\n          ok: true,\n          data: {\n            unit_id: (_project$scenes$0$id4 = (_project$scenes$7 = project.scenes[0]) === null || _project$scenes$7 === void 0 ? void 0 : _project$scenes$7.id) !== null && _project$scenes$0$id4 !== void 0 ? _project$scenes$0$id4 : 'sc_0001',\n            checksum: 'stub-checksum',\n            schema_version: 'DraftAcceptResult v1',\n            snapshot: {\n              snapshot_id: '20250101T000000Z',\n              label: 'accept',\n              created_at: '2025-01-01T00:00:00Z',\n              path: 'history/snapshots/20250101T000000Z_accept'\n            },\n            budget: {\n              estimated_usd: 0.15,\n              status: 'ok',\n              soft_limit_usd: 10,\n              hard_limit_usd: 10,\n              spent_usd: 1.4,\n              total_after_usd: 1.4\n            }\n          },\n          traceId: 'trace-accept'\n        };\n      },\n      async createSnapshot() {\n        return {\n          ok: true,\n          data: {\n            snapshot_id: '20250101T000000Z',\n            label: 'accept',\n            created_at: '2025-01-01T00:00:00Z',\n            path: 'history/snapshots/20250101T000000Z_accept'\n          },\n          traceId: 'trace-snapshot'\n        };\n      },\n      async getRecoveryStatus() {\n        return {\n          ok: true,\n          data: {\n            project_id: project.project_id,\n            status: 'idle',\n            needs_recovery: false,\n            last_snapshot: null\n          },\n          traceId: 'trace-recovery'\n        };\n      },\n      async restoreSnapshot() {\n        return {\n          ok: true,\n          data: {\n            project_id: project.project_id,\n            status: 'idle',\n            needs_recovery: false\n          },\n          traceId: 'trace-restore'\n        };\n      }\n    };\n    const projectLoader = {\n      async openProjectDialog() {\n        return {\n          canceled: false,\n          filePath: project.path\n        };\n      },\n      async loadProject() {\n        return {\n          ok: true,\n          project,\n          issues: []\n        };\n      },\n      async getSampleProjectPath() {\n        return project.path;\n      }\n    };\n    const layoutBridge = {\n      async loadLayout(request) {\n        layoutCalls.loadLayout.push({\n          projectPath: request.projectPath,\n          layout: layoutState.savedLayout\n        });\n        return {\n          layout: layoutState.savedLayout,\n          floatingPanes: layoutState.floatingPanes,\n          schemaVersion: 2\n        };\n      },\n      async saveLayout(request) {\n        layoutCalls.saveLayout.push({\n          projectPath: request.projectPath,\n          layout: request.layout\n        });\n        layoutState.savedLayout = request.layout;\n      },\n      async resetLayout() {\n        layoutState.savedLayout = null;\n        layoutState.floatingPanes = [];\n      },\n      async listFloatingPanes() {\n        return layoutState.floatingPanes;\n      },\n      async openFloatingPane(request) {\n        layoutCalls.openFloating.push({\n          projectPath: request.projectPath,\n          paneId: request.paneId\n        });\n        layoutState.floatingPanes = layoutState.floatingPanes.filter(entry => entry.id !== request.paneId).concat({\n          id: request.paneId,\n          bounds: request.bounds\n        });\n        return {\n          opened: true,\n          clamp: null\n        };\n      },\n      async closeFloatingPane(request) {\n        layoutState.floatingPanes = layoutState.floatingPanes.filter(entry => entry.id !== request.paneId);\n      }\n    };\n    const runtimeConfig = {\n      ui: {\n        enableDocking: true,\n        defaultPreset: 'standard',\n        hotkeys: {\n          enablePresetHotkeys: true,\n          focusCycleOrder: ['wizard', 'draft-board', 'critique', 'history']\n        }\n      }\n    };\n    Object.defineProperty(window, '__layoutCallLog', {\n      value: layoutCalls,\n      configurable: true\n    });\n    Object.defineProperty(window, '__layoutState', {\n      value: layoutState,\n      configurable: true\n    });\n    Object.defineProperty(window, 'runtimeConfig', {\n      value: runtimeConfig,\n      configurable: true\n    });\n    Object.defineProperty(window, '__runtimeConfigOverride', {\n      value: runtimeConfig,\n      configurable: true\n    });\n    Object.defineProperty(window, 'layout', {\n      value: layoutBridge,\n      configurable: true\n    });\n    Object.defineProperty(window, 'services', {\n      value: services,\n      configurable: true\n    });\n    Object.defineProperty(window, 'projectLoader', {\n      value: projectLoader,\n      configurable: true\n    });\n    Object.defineProperty(window, '__setServiceStatus', {\n      value: nextStatus => {\n        healthState.status = nextStatus;\n      },\n      configurable: true\n    });\n  })({\"project\":{\"path\":\"C:/Dev/black-skies/sample_project/proj_esther_estate\",\"name\":\"Esther Estate\",\"outline\":{\"schema_version\":\"OutlineSchema v1\",\"outline_id\":\"out_001\",\"acts\":[\"Act I: Gathered Storm\"],\"chapters\":[{\"id\":\"ch_0001\",\"order\":1,\"title\":\"The Summons\"}],\"scenes\":[{\"id\":\"sc_0001\",\"order\":1,\"title\":\"Basement Pulse\",\"chapter_id\":\"ch_0001\",\"beat_refs\":[\"inciting\"]},{\"id\":\"sc_0002\",\"order\":2,\"title\":\"Locked Parlor\",\"chapter_id\":\"ch_0001\",\"beat_refs\":[\"turn\"]}]},\"scenes\":[{\"id\":\"sc_0001\",\"title\":\"Basement Pulse\",\"order\":1,\"chapter_id\":\"ch_0001\",\"beat_refs\":[\"inciting\"],\"purpose\":\"escalation\",\"emotion_tag\":\"tension\"},{\"id\":\"sc_0002\",\"title\":\"Locked Parlor\",\"order\":2,\"chapter_id\":\"ch_0001\",\"beat_refs\":[\"turn\"],\"purpose\":\"escalation\",\"emotion_tag\":\"tension\"}],\"drafts\":{\"sc_0001\":\"---\\r\\nid: sc_0001\\r\\nslug: basement-pulse\\r\\ntitle: Basement Pulse\\r\\npov: Mara Ibarra\\r\\npurpose: escalation\\r\\ngoal: stabilize the perimeter sensors\\r\\nconflict: footsteps echo from nowhere\\r\\nturn: the house remembers a forgotten route\\r\\nemotion_tag: respite\\r\\nword_target: 890\\r\\norder: 1\\r\\nchapter_id: ch_0001\\r\\nbeats: [inciting]\\r\\n---\\r\\nMara Ibarra enters Basement Pulse to stabilize the perimeter sensors. The atmosphere leans toward respite as footsteps echo from nowhere.\\r\\n\\r\\nThe beat shifts when the house remembers a forgotten route, keeping the scene in escalation mode and aiming for roughly 890 words.\\r\\n\",\"sc_0002\":\"---\\r\\nid: sc_0002\\r\\nslug: locked-parlor\\r\\ntitle: Locked Parlor\\r\\npov: Jun Park\\r\\npurpose: payoff\\r\\ngoal: keep the generator coil alive\\r\\nconflict: humidity chews through every circuit\\r\\nturn: the house remembers a forgotten route\\r\\nemotion_tag: revelation\\r\\nword_target: 930\\r\\norder: 2\\r\\nchapter_id: ch_0001\\r\\nbeats: [turn]\\r\\n---\\r\\nJun Park enters Locked Parlor to keep the generator coil alive. The atmosphere leans toward revelation as humidity chews through every circuit.\\r\\n\\r\\nThe beat shifts when the house remembers a forgotten route, keeping the scene in payoff mode and aiming for roughly 930 words.\\r\\n\"},\"project_id\":\"proj_esther_estate\"}})"},"stack":[{"file":"C:\\Dev\\black-skies\\app\\tests\\e2e\\gui.insights.spec.ts","line":18,"column":3}],"group":"configuration"}
{"type":"after","callId":"pw:api@42","endTime":2240.464,"annotations":[]}
{"type":"after","callId":"hook@2","endTime":2240.737,"annotations":[]}
{"type":"after","callId":"hook@1","endTime":2241.249,"annotations":[]}
{"type":"before","callId":"pw:api@43","stepId":"pw:api@43","startTime":2245.364,"class":"Test","method":"pw:api","title":"Wait for load state \"domcontentloaded\"","params":{"info":"Object"},"stack":[{"file":"C:\\Dev\\black-skies\\app\\tests\\e2e\\gui.insights.spec.ts","line":239,"column":14}]}
{"type":"after","callId":"pw:api@43","endTime":2246.754,"annotations":[]}
{"type":"before","callId":"pw:api@44","stepId":"pw:api@44","startTime":2252.212,"class":"Test","method":"pw:api","title":"Wait for selector getByTestId('project-open-btn')","params":{"selector":"internal:testid=[data-testid=\"project-open-btn\"s]","strict":"true","omitReturnValue":"true","state":"visible","timeout":"45000"},"stack":[{"file":"C:\\Dev\\black-skies\\app\\tests\\e2e\\gui.insights.spec.ts","line":244,"column":6}]}
{"type":"after","callId":"pw:api@44","endTime":47277.821,"annotations":[],"error":{"name":"","message":"TimeoutError: locator.waitFor: Timeout 45000ms exceeded.\nCall log:\n\u001b[2m  - waiting for getByTestId('project-open-btn') to be visible\u001b[22m\n","stack":"TimeoutError: locator.waitFor: Timeout 45000ms exceeded.\nCall log:\n\u001b[2m  - waiting for getByTestId('project-open-btn') to be visible\u001b[22m\n\n    at C:\\Dev\\black-skies\\app\\tests\\e2e\\gui.insights.spec.ts:244:6"}}
{"type":"before","callId":"expect@45","stepId":"expect@45","startTime":47280.077,"class":"Test","method":"expect","title":"Expect \"toBeVisible\"","params":{"expected":"Object"},"stack":[{"file":"C:\\Dev\\black-skies\\app\\tests\\e2e\\gui.insights.spec.ts","line":251,"column":33}]}
{"type":"error","message":"\u001b[31mTest timeout of 90000ms exceeded.\u001b[39m","stack":[]}
{"type":"before","callId":"hook@46","stepId":"hook@46","startTime":92064.81,"class":"Test","method":"hook","title":"After Hooks","params":{},"stack":[]}
{"type":"before","callId":"fixture@47","stepId":"fixture@47","parentId":"hook@46","startTime":92122.658,"class":"Test","method":"fixture","title":"Fixture \"page\"","params":{},"stack":[]}
{"type":"after","callId":"fixture@47","endTime":92122.826,"annotations":[]}
{"type":"before","callId":"fixture@48","stepId":"fixture@48","parentId":"hook@46","startTime":92122.98,"class":"Test","method":"fixture","title":"Fixture \"context\"","params":{},"stack":[]}
{"type":"before","callId":"pw:api@49","stepId":"pw:api@49","parentId":"fixture@48","startTime":92154.518,"class":"Test","method":"pw:api","title":"Close context","params":{"reason":"Test timeout of 90000ms exceeded."},"stack":[]}
{"type":"after","callId":"expect@45","endTime":92166.918,"annotations":[],"error":{"name":"","message":"Error: \u001b[2mexpect(\u001b[22m\u001b[31mlocator\u001b[39m\u001b[2m).\u001b[22mtoBeVisible\u001b[2m(\u001b[22m\u001b[2m)\u001b[22m failed\n\nLocator: getByTestId('dock-workspace')\nExpected: visible\nError: element(s) not found\n\nCall log:\n\u001b[2m  - Expect \"toBeVisible\" with timeout 60000ms\u001b[22m\n\u001b[2m  - waiting for getByTestId('dock-workspace')\u001b[22m\n","stack":"Error: \u001b[2mexpect(\u001b[22m\u001b[31mlocator\u001b[39m\u001b[2m).\u001b[22mtoBeVisible\u001b[2m(\u001b[22m\u001b[2m)\u001b[22m failed\n\nLocator: getByTestId('dock-workspace')\nExpected: visible\nError: element(s) not found\n\nCall log:\n\u001b[2m  - Expect \"toBeVisible\" with timeout 60000ms\u001b[22m\n\u001b[2m  - waiting for getByTestId('dock-workspace')\u001b[22m\n\n    at C:\\Dev\\black-skies\\app\\tests\\e2e\\gui.insights.spec.ts:251:33"}}
{"type":"error","message":"Error: \u001b[2mexpect(\u001b[22m\u001b[31mlocator\u001b[39m\u001b[2m).\u001b[22mtoBeVisible\u001b[2m(\u001b[22m\u001b[2m)\u001b[22m failed\n\nLocator: getByTestId('dock-workspace')\nExpected: visible\nError: element(s) not found\n\nCall log:\n\u001b[2m  - Expect \"toBeVisible\" with timeout 60000ms\u001b[22m\n\u001b[2m  - waiting for getByTestId('dock-workspace')\u001b[22m\n","stack":[{"file":"C:\\Dev\\black-skies\\app\\tests\\e2e\\gui.insights.spec.ts","line":251,"column":33}]}
{"type":"after","callId":"pw:api@49","endTime":97136.421,"annotations":[]}
{"type":"after","callId":"fixture@48","endTime":97139.361,"attachments":[{"name":"video","contentType":"video/webm","sha1":"743aedaa2b487d23725da150720ab915707f99d1"}],"annotations":[]}
{"type":"after","callId":"hook@46","endTime":97144.623,"attachments":[{"name":"screenshot","contentType":"image/png","sha1":"7a33d5db6370b6de345e990751aa1f1da65ad675"}],"annotations":[]}
{"type":"before","callId":"hook@80","stepId":"hook@80","startTime":97144.767,"class":"Test","method":"hook","title":"Worker Cleanup","params":{},"stack":[]}
{"type":"before","callId":"fixture@83","stepId":"fixture@83","parentId":"hook@80","startTime":97145.443,"class":"Test","method":"fixture","title":"Fixture \"video\"","params":{},"stack":[{"file":"project#electron","line":1,"column":1}],"group":"configuration"}
{"type":"after","callId":"fixture@83","endTime":97145.469,"annotations":[]}
{"type":"before","callId":"fixture@84","stepId":"fixture@84","parentId":"hook@80","startTime":97145.616,"class":"Test","method":"fixture","title":"Fixture \"browser\"","params":{},"stack":[]}
{"type":"after","callId":"fixture@84","endTime":97281.886,"annotations":[]}
{"type":"before","callId":"fixture@89","stepId":"fixture@89","parentId":"hook@80","startTime":97282.744,"class":"Test","method":"fixture","title":"Fixture \"screenshot\"","params":{},"stack":[{"file":"project#electron","line":1,"column":1}],"group":"configuration"}
{"type":"after","callId":"fixture@89","endTime":97282.765,"annotations":[]}
{"type":"before","callId":"fixture@93","stepId":"fixture@93","parentId":"hook@80","startTime":97283.465,"class":"Test","method":"fixture","title":"Fixture \"launchOptions\"","params":{},"stack":[{"file":"project#electron","line":1,"column":1}],"group":"configuration"}
{"type":"after","callId":"fixture@93","endTime":97283.484,"annotations":[]}
{"type":"after","callId":"hook@80","endTime":97283.643,"annotations":[]}