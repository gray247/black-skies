{"version":8,"type":"context-options","origin":"library","browserName":"chromium","options":{"noDefaultViewport":false,"viewport":{"width":1280,"height":720},"ignoreHTTPSErrors":false,"javaScriptEnabled":true,"bypassCSP":false,"locale":"en-US","offline":false,"isMobile":false,"hasTouch":false,"colorScheme":"light","acceptDownloads":"accept","recordVideo":{"dir":"C:\\Dev\\black-skies\\app\\test-results\\.playwright-artifacts-0","size":{"width":800,"height":450}},"serviceWorkers":"allow","selectorEngines":[],"testIdAttributeName":"data-testid"},"platform":"win32","wallTime":1762747170869,"monotonicTime":2081.831,"sdkLanguage":"javascript","testIdAttributeName":"data-testid","contextId":"browser-context@4a7568e1acf3fd50f3065470d04711e4","title":"gui.insights.spec.ts:238 â€º insights queue honors offline gating and resumes when online"}
{"type":"before","callId":"call@6","startTime":2088.76,"class":"BrowserContext","method":"newPage","params":{},"stepId":"pw:api@41","beforeSnapshot":"before@call@6"}
{"type":"event","time":2224.533,"class":"BrowserContext","method":"page","params":{"pageId":"page@bcb86d638dd6fe812e3ed13a362626ac"}}
{"type":"after","callId":"call@6","endTime":2224.77,"result":{"page":"<Page>"},"afterSnapshot":"after@call@6"}
{"type":"before","callId":"call@9","startTime":2237.459,"class":"Page","method":"addInitScript","params":{"source":"(({\n    project\n  }) => {\n    const layoutCalls = {\n      openFloating: [],\n      saveLayout: [],\n      loadLayout: []\n    };\n    const layoutState = {\n      savedLayout: null,\n      floatingPanes: []\n    };\n    const healthState = {\n      status: 'online'\n    };\n    const services = {\n      async checkHealth() {\n        if (healthState.status === 'online') {\n          return {\n            ok: true,\n            data: {\n              status: 'online'\n            },\n            traceId: 'trace-health'\n          };\n        }\n        return {\n          ok: false,\n          error: {\n            message: 'Bridge offline'\n          },\n          traceId: 'trace-health-offline'\n        };\n      },\n      async buildOutline() {\n        return {\n          ok: true,\n          data: project.outline,\n          traceId: 'trace-outline'\n        };\n      },\n      async preflightDraft() {\n        var _project$scenes$0$id, _project$scenes$, _project$scenes$0$id2, _project$scenes$2, _project$scenes$0$tit, _project$scenes$3, _project$scenes$0$ord, _project$scenes$4, _project$scenes$5;\n        return {\n          ok: true,\n          data: {\n            projectId: project.project_id,\n            unitScope: 'scene',\n            unitIds: [(_project$scenes$0$id = (_project$scenes$ = project.scenes[0]) === null || _project$scenes$ === void 0 ? void 0 : _project$scenes$.id) !== null && _project$scenes$0$id !== void 0 ? _project$scenes$0$id : 'sc_0001'],\n            scenes: [{\n              id: (_project$scenes$0$id2 = (_project$scenes$2 = project.scenes[0]) === null || _project$scenes$2 === void 0 ? void 0 : _project$scenes$2.id) !== null && _project$scenes$0$id2 !== void 0 ? _project$scenes$0$id2 : 'sc_0001',\n              title: (_project$scenes$0$tit = (_project$scenes$3 = project.scenes[0]) === null || _project$scenes$3 === void 0 ? void 0 : _project$scenes$3.title) !== null && _project$scenes$0$tit !== void 0 ? _project$scenes$0$tit : 'Scene',\n              order: (_project$scenes$0$ord = (_project$scenes$4 = project.scenes[0]) === null || _project$scenes$4 === void 0 ? void 0 : _project$scenes$4.order) !== null && _project$scenes$0$ord !== void 0 ? _project$scenes$0$ord : 1,\n              chapter_id: (_project$scenes$5 = project.scenes[0]) === null || _project$scenes$5 === void 0 ? void 0 : _project$scenes$5.chapter_id\n            }],\n            budget: {\n              estimated_usd: 1.25,\n              status: 'ok',\n              soft_limit_usd: 10,\n              hard_limit_usd: 10,\n              spent_usd: 1.25,\n              total_after_usd: 1.25\n            }\n          },\n          traceId: 'trace-preflight'\n        };\n      },\n      async generateDraft() {\n        return {\n          ok: true,\n          data: {\n            draft_id: 'dr_stub',\n            schema_version: 'DraftUnitSchema v1',\n            units: [],\n            budget: {\n              status: 'ok'\n            }\n          },\n          traceId: 'trace-generate'\n        };\n      },\n      async critiqueDraft() {\n        var _project$scenes$0$id3, _project$scenes$6;\n        return {\n          ok: true,\n          data: {\n            unit_id: (_project$scenes$0$id3 = (_project$scenes$6 = project.scenes[0]) === null || _project$scenes$6 === void 0 ? void 0 : _project$scenes$6.id) !== null && _project$scenes$0$id3 !== void 0 ? _project$scenes$0$id3 : 'sc_0001',\n            schema_version: 'CritiqueOutputSchema v1',\n            summary: 'Stub critique summary.',\n            model: {\n              name: 'critique-stub',\n              provider: 'stub'\n            },\n            budget: {\n              estimated_usd: 0.15,\n              status: 'ok',\n              soft_limit_usd: 10,\n              hard_limit_usd: 10,\n              spent_usd: 1.4,\n              total_after_usd: 1.4\n            },\n            line_comments: [],\n            priorities: ['Voice']\n          },\n          traceId: 'trace-critique'\n        };\n      },\n      async acceptDraft() {\n        var _project$scenes$0$id4, _project$scenes$7;\n        return {\n          ok: true,\n          data: {\n            unit_id: (_project$scenes$0$id4 = (_project$scenes$7 = project.scenes[0]) === null || _project$scenes$7 === void 0 ? void 0 : _project$scenes$7.id) !== null && _project$scenes$0$id4 !== void 0 ? _project$scenes$0$id4 : 'sc_0001',\n            checksum: 'stub-checksum',\n            schema_version: 'DraftAcceptResult v1',\n            snapshot: {\n              snapshot_id: '20250101T000000Z',\n              label: 'accept',\n              created_at: '2025-01-01T00:00:00Z',\n              path: 'history/snapshots/20250101T000000Z_accept'\n            },\n            budget: {\n              estimated_usd: 0.15,\n              status: 'ok',\n              soft_limit_usd: 10,\n              hard_limit_usd: 10,\n              spent_usd: 1.4,\n              total_after_usd: 1.4\n            }\n          },\n          traceId: 'trace-accept'\n        };\n      },\n      async createSnapshot() {\n        return {\n          ok: true,\n          data: {\n            snapshot_id: '20250101T000000Z',\n            label: 'accept',\n            created_at: '2025-01-01T00:00:00Z',\n            path: 'history/snapshots/20250101T000000Z_accept'\n          },\n          traceId: 'trace-snapshot'\n        };\n      },\n      async getRecoveryStatus() {\n        return {\n          ok: true,\n          data: {\n            project_id: project.project_id,\n            status: 'idle',\n            needs_recovery: false,\n            last_snapshot: null\n          },\n          traceId: 'trace-recovery'\n        };\n      },\n      async restoreSnapshot() {\n        return {\n          ok: true,\n          data: {\n            project_id: project.project_id,\n            status: 'idle',\n            needs_recovery: false\n          },\n          traceId: 'trace-restore'\n        };\n      }\n    };\n    const projectLoader = {\n      async openProjectDialog() {\n        return {\n          canceled: false,\n          filePath: project.path\n        };\n      },\n      async loadProject() {\n        return {\n          ok: true,\n          project,\n          issues: []\n        };\n      },\n      async getSampleProjectPath() {\n        return project.path;\n      }\n    };\n    const layoutBridge = {\n      async loadLayout(request) {\n        layoutCalls.loadLayout.push({\n          projectPath: request.projectPath,\n          layout: layoutState.savedLayout\n        });\n        return {\n          layout: layoutState.savedLayout,\n          floatingPanes: layoutState.floatingPanes,\n          schemaVersion: 2\n        };\n      },\n      async saveLayout(request) {\n        layoutCalls.saveLayout.push({\n          projectPath: request.projectPath,\n          layout: request.layout\n        });\n        layoutState.savedLayout = request.layout;\n      },\n      async resetLayout() {\n        layoutState.savedLayout = null;\n        layoutState.floatingPanes = [];\n      },\n      async listFloatingPanes() {\n        return layoutState.floatingPanes;\n      },\n      async openFloatingPane(request) {\n        layoutCalls.openFloating.push({\n          projectPath: request.projectPath,\n          paneId: request.paneId\n        });\n        layoutState.floatingPanes = layoutState.floatingPanes.filter(entry => entry.id !== request.paneId).concat({\n          id: request.paneId,\n          bounds: request.bounds\n        });\n        return {\n          opened: true,\n          clamp: null\n        };\n      },\n      async closeFloatingPane(request) {\n        layoutState.floatingPanes = layoutState.floatingPanes.filter(entry => entry.id !== request.paneId);\n      }\n    };\n    const runtimeConfig = {\n      ui: {\n        enableDocking: true,\n        defaultPreset: 'standard',\n        hotkeys: {\n          enablePresetHotkeys: true,\n          focusCycleOrder: ['wizard', 'draft-board', 'critique', 'history']\n        }\n      }\n    };\n    Object.defineProperty(window, '__layoutCallLog', {\n      value: layoutCalls,\n      configurable: true\n    });\n    Object.defineProperty(window, '__layoutState', {\n      value: layoutState,\n      configurable: true\n    });\n    Object.defineProperty(window, 'runtimeConfig', {\n      value: runtimeConfig,\n      configurable: true\n    });\n    Object.defineProperty(window, '__runtimeConfigOverride', {\n      value: runtimeConfig,\n      configurable: true\n    });\n    Object.defineProperty(window, 'layout', {\n      value: layoutBridge,\n      configurable: true\n    });\n    Object.defineProperty(window, 'services', {\n      value: services,\n      configurable: true\n    });\n    Object.defineProperty(window, 'projectLoader', {\n      value: projectLoader,\n      configurable: true\n    });\n    Object.defineProperty(window, '__setServiceStatus', {\n      value: nextStatus => {\n        healthState.status = nextStatus;\n      },\n      configurable: true\n    });\n  })({\"project\":{\"path\":\"C:/Dev/black-skies/sample_project/proj_esther_estate\",\"name\":\"Esther Estate\",\"outline\":{\"schema_version\":\"OutlineSchema v1\",\"outline_id\":\"out_001\",\"acts\":[\"Act I: Gathered Storm\"],\"chapters\":[{\"id\":\"ch_0001\",\"order\":1,\"title\":\"The Summons\"}],\"scenes\":[{\"id\":\"sc_0001\",\"order\":1,\"title\":\"Basement Pulse\",\"chapter_id\":\"ch_0001\",\"beat_refs\":[\"inciting\"]},{\"id\":\"sc_0002\",\"order\":2,\"title\":\"Locked Parlor\",\"chapter_id\":\"ch_0001\",\"beat_refs\":[\"turn\"]}]},\"scenes\":[{\"id\":\"sc_0001\",\"title\":\"Basement Pulse\",\"order\":1,\"chapter_id\":\"ch_0001\",\"beat_refs\":[\"inciting\"],\"purpose\":\"escalation\",\"emotion_tag\":\"tension\"},{\"id\":\"sc_0002\",\"title\":\"Locked Parlor\",\"order\":2,\"chapter_id\":\"ch_0001\",\"beat_refs\":[\"turn\"],\"purpose\":\"escalation\",\"emotion_tag\":\"tension\"}],\"drafts\":{\"sc_0001\":\"---\\r\\nid: sc_0001\\r\\nslug: basement-pulse\\r\\ntitle: Basement Pulse\\r\\npov: Mara Ibarra\\r\\npurpose: escalation\\r\\ngoal: stabilize the perimeter sensors\\r\\nconflict: footsteps echo from nowhere\\r\\nturn: the house remembers a forgotten route\\r\\nemotion_tag: respite\\r\\nword_target: 890\\r\\norder: 1\\r\\nchapter_id: ch_0001\\r\\nbeats: [inciting]\\r\\n---\\r\\nMara Ibarra enters Basement Pulse to stabilize the perimeter sensors. The atmosphere leans toward respite as footsteps echo from nowhere.\\r\\n\\r\\nThe beat shifts when the house remembers a forgotten route, keeping the scene in escalation mode and aiming for roughly 890 words.\\r\\n\",\"sc_0002\":\"---\\r\\nid: sc_0002\\r\\nslug: locked-parlor\\r\\ntitle: Locked Parlor\\r\\npov: Jun Park\\r\\npurpose: payoff\\r\\ngoal: keep the generator coil alive\\r\\nconflict: humidity chews through every circuit\\r\\nturn: the house remembers a forgotten route\\r\\nemotion_tag: revelation\\r\\nword_target: 930\\r\\norder: 2\\r\\nchapter_id: ch_0001\\r\\nbeats: [turn]\\r\\n---\\r\\nJun Park enters Locked Parlor to keep the generator coil alive. The atmosphere leans toward revelation as humidity chews through every circuit.\\r\\n\\r\\nThe beat shifts when the house remembers a forgotten route, keeping the scene in payoff mode and aiming for roughly 930 words.\\r\\n\"},\"project_id\":\"proj_esther_estate\"}})"},"stepId":"pw:api@42","pageId":"page@bcb86d638dd6fe812e3ed13a362626ac","beforeSnapshot":"before@call@9"}
{"type":"after","callId":"call@9","endTime":2239.99,"afterSnapshot":"after@call@9"}
{"type":"before","callId":"call@11","startTime":2252.985,"title":"Wait for load state \"domcontentloaded\"","class":"Page","method":"waitForEventInfo","params":{"info":{"waitId":"834c2b63aa39b457eaa632e8d7d059d5","phase":"before","event":""}},"stepId":"pw:api@43","pageId":"page@bcb86d638dd6fe812e3ed13a362626ac","beforeSnapshot":"before@call@11"}
{"type":"log","callId":"call@11","time":2257.078,"message":"  not waiting, \"domcontentloaded\" event already fired"}
{"type":"after","callId":"call@11","endTime":2257.141,"afterSnapshot":"after@call@11"}
{"type":"before","callId":"call@15","startTime":2257.754,"class":"Frame","method":"waitForSelector","params":{"selector":"internal:testid=[data-testid=\"project-open-btn\"s]","strict":true,"timeout":45000,"state":"visible","omitReturnValue":true},"stepId":"pw:api@44","pageId":"page@bcb86d638dd6fe812e3ed13a362626ac","beforeSnapshot":"before@call@15"}
{"type":"frame-snapshot","snapshot":{"callId":"call@11","snapshotName":"before@call@11","pageId":"page@bcb86d638dd6fe812e3ed13a362626ac","frameId":"frame@14b8951c30c80fa64dce63862a0cfef5","frameUrl":"about:blank","html":["HTML",{},["HEAD",{},["BASE",{"href":"about:blank"}]],["BODY"]],"viewport":{"width":1280,"height":720},"timestamp":2261.389,"wallTime":1762747171051,"collectionTime":1.199999988079071,"resourceOverrides":[],"isMainFrame":true}}
{"type":"frame-snapshot","snapshot":{"callId":"call@11","snapshotName":"after@call@11","pageId":"page@bcb86d638dd6fe812e3ed13a362626ac","frameId":"frame@14b8951c30c80fa64dce63862a0cfef5","frameUrl":"about:blank","html":[[1,3]],"viewport":{"width":1280,"height":720},"timestamp":2261.986,"wallTime":1762747171051,"collectionTime":0.09999996423721313,"resourceOverrides":[],"isMainFrame":true}}
{"type":"frame-snapshot","snapshot":{"callId":"call@15","snapshotName":"before@call@15","pageId":"page@bcb86d638dd6fe812e3ed13a362626ac","frameId":"frame@14b8951c30c80fa64dce63862a0cfef5","frameUrl":"about:blank","html":[[2,3]],"viewport":{"width":1280,"height":720},"timestamp":2262.128,"wallTime":1762747171051,"collectionTime":0.19999998807907104,"resourceOverrides":[],"isMainFrame":true}}
{"type":"log","callId":"call@15","time":2263.357,"message":"waiting for getByTestId('project-open-btn') to be visible"}
{"type":"screencast-frame","pageId":"page@bcb86d638dd6fe812e3ed13a362626ac","sha1":"page@bcb86d638dd6fe812e3ed13a362626ac-1762747171221.jpeg","width":1280.531005859375,"height":720.35400390625,"timestamp":2433.779,"frameSwapWallTime":1762747171220.789}
{"type":"screencast-frame","pageId":"page@bcb86d638dd6fe812e3ed13a362626ac","sha1":"page@bcb86d638dd6fe812e3ed13a362626ac-1762747171237.jpeg","width":1280.531005859375,"height":720.35400390625,"timestamp":2449.706,"frameSwapWallTime":1762747171236.898}
{"type":"after","callId":"call@15","endTime":47274.985,"error":{"message":"Timeout 45000ms exceeded.","stack":"TimeoutError: Timeout 45000ms exceeded.\n    at ProgressController.run (C:\\Dev\\black-skies\\node_modules\\.pnpm\\playwright-core@1.56.1\\node_modules\\playwright-core\\lib\\server\\progress.js:68:28)\n    at FrameDispatcher._runCommand (C:\\Dev\\black-skies\\node_modules\\.pnpm\\playwright-core@1.56.1\\node_modules\\playwright-core\\lib\\server\\dispatchers\\dispatcher.js:95:31)\n    at DispatcherConnection.dispatch (C:\\Dev\\black-skies\\node_modules\\.pnpm\\playwright-core@1.56.1\\node_modules\\playwright-core\\lib\\server\\dispatchers\\dispatcher.js:329:39)","name":"TimeoutError"},"afterSnapshot":"after@call@15"}
{"type":"frame-snapshot","snapshot":{"callId":"call@15","snapshotName":"after@call@15","pageId":"page@bcb86d638dd6fe812e3ed13a362626ac","frameId":"frame@14b8951c30c80fa64dce63862a0cfef5","frameUrl":"about:blank","html":[[3,3]],"viewport":{"width":1280,"height":720},"timestamp":47276.598,"wallTime":1762747216066,"collectionTime":0.19999998807907104,"resourceOverrides":[],"isMainFrame":true}}
{"type":"before","callId":"call@17","startTime":47283.589,"title":"Expect \"toBeVisible\"","class":"Frame","method":"expect","params":{"selector":"internal:testid=[data-testid=\"dock-workspace\"s]","expression":"to.be.visible","expectedValue":{"value":{"v":"undefined"},"handles":[]},"isNot":false,"timeout":60000},"stepId":"expect@45","pageId":"page@bcb86d638dd6fe812e3ed13a362626ac","beforeSnapshot":"before@call@17"}
{"type":"frame-snapshot","snapshot":{"callId":"call@17","snapshotName":"before@call@17","pageId":"page@bcb86d638dd6fe812e3ed13a362626ac","frameId":"frame@14b8951c30c80fa64dce63862a0cfef5","frameUrl":"about:blank","html":[[4,3]],"viewport":{"width":1280,"height":720},"timestamp":47284.725,"wallTime":1762747216074,"collectionTime":0.10000002384185791,"resourceOverrides":[],"isMainFrame":true}}
{"type":"log","callId":"call@17","time":47285.666,"message":"Expect \"toBeVisible\" with timeout 60000ms"}
{"type":"log","callId":"call@17","time":47285.692,"message":"waiting for getByTestId('dock-workspace')"}
{"type":"screencast-frame","pageId":"page@bcb86d638dd6fe812e3ed13a362626ac","sha1":"page@bcb86d638dd6fe812e3ed13a362626ac-1762747260909.jpeg","width":1280.531005859375,"height":720.35400390625,"timestamp":92120.972,"frameSwapWallTime":1762747260907.981}
